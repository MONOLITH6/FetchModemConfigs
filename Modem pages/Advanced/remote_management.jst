
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">




<head>
	<!--CSS-->
	<link rel="stylesheet" type="text/css" media="screen" href="./cmn/css/common-min.css" />
	<!--[if IE 6]>
	<link rel="stylesheet" type="text/css" href="./cmn/css/ie6-min.css" />
	<![endif]-->
	<!--[if IE 7]>
	<link rel="stylesheet" type="text/css" href="./cmn/css/ie7-min.css" />
	<![endif]-->
	<link rel="stylesheet" type="text/css" media="print" href="./cmn/css/print.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="./cmn/css/lib/jquery.radioswitch.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="./cmn/css/lib/progressBar.css" />
	<!--Character Encoding-->
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta name="robots" content="noindex,nofollow">
    <script type="text/javascript" src="./cmn/js/lib/jquery-3.4.1.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/jquery-migrate-1.2.1.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/jquery.validate.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/jquery.alerts.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.ciscoExt.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.highContrastDetect.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.radioswitch.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.virtualDialog.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/bootstrap-waitingfor.js"></script>
    <!-- update the version of utilityFunctions.js if any changes is made to this js file otherwise browser will take the old js file from the cache memory -->
	<script type="text/javascript" src="./cmn/js/utilityFunctions.js?v=1"></script>
    <script type="text/javascript" src="./cmn/js/comcast.js"></script>
    
</head>
<script type="text/javascript">
	$(document).ready(function() {
		$("table.data td").each(function() {
			if($(this).text().split("\n")[0].length > 25)
			{
				$(this).closest('table').css("table-layout", "fixed");
				$(this).css("word-wrap", "break-word");
			}
		});
	});
</script>

<body>
    <!--Main Container - Centers Everything-->
	<div id="container">

		<!--Header-->
		<div id="header">
			<h2 id="logo" class="logo_title"><img src="./cmn/img/logo_xfinity.png" alt="Company logo" title="Company logo" /></h2>
			<p class="bridmar">
				<strong>
				
				</strong>
			</p>
		</div> <!-- end #header -->

		<div id='div-skip-to' class="acs-hide">
			<a id="skip-link" name="skip-link" href="#content">Skip to content</a>
		</div>
		
		<!--Main Content-->
		<div id="main-content">


<!-- $Id: device_discovery.jst 3158 2010-01-08 23:32:05Z slemoine $ -->
<div id="sub-header">
	
<!--dynamic generate user bar icon and tips-->



<script type="text/javascript">
setTimeout(function() {
	/*
	* get status when hover or tab focused one by one
	* but for screen reader we have to load all status once
	* below code can easily rollback
	*/
	//update user bar
	//var sessionCsrf= "dauz8cauea";
	//if(document.cookie==""){
	//	sessionStorage.setItem("Csrfp_token",sessionCsrf);
	//}
	$.ajax({
		type: "GET",
		url: "actionHandler/ajaxSet_userbar.jst",
		data: { configInfo: "noData" },
		dataType: "json",
		success: function(msg) {
			// theObj.find(".tooltip").html(msg.tips);
			for (var i=0; i<msg.tags.length; i++){
				$("#"+msg.tags[i]).find(".tooltip").html(msg.tips[i].replace(/-/g, "<br/>"));
				$("#"+msg.tags[i]).removeClass("off");
				if(msg.mainStatus[i]=="false")$("#"+msg.tags[i]).addClass("off");
				if(msg.tags[i] === "sta_fire")
				{
					if (!(("High"== msg.mainStatus[i]) || ("Medium"==msg.mainStatus[i]))) 
					{
						$("#"+msg.tags[i]).addClass("off");
					}
					$("#sta_fire a>span").text(msg.mainStatus[i] + " Security")
				}
			}
			//$sta_batt,$battery_class
			$("#sta_batt a").text(msg.mainStatus[4]+"%");
			$("#sta_batt > div > span").removeClass().addClass(msg.mainStatus[5]);
		},
		error: function(){
			// does something
		}
	});

	//when clicked on this page, restart timer
	var jsInactTimeout = parseInt("840") * 1000;
	// if ("") jsInactTimeout = 5000;	// 5 seconds debug
	
	// var h_timer = setTimeout('alert("You are being logged out due to inactivity."); location.href="home_loggedout.jst";', jsInactTimeout);
	var h_timer = null;
	$(document).click(function() {
		// do not handle click if no-login for GA
		// if ("" == "") {
			// return;
		// }			
	
		// do not handle click event when count-down show up
		if ($("#count_down").length > 0) {
			return;
		}
		// console.log(h_timer);
		
		clearTimeout(h_timer);
		h_timer = setTimeout(function(){
			var cnt		= 60;
			var h_cntd  = setInterval(function(){
				$("#count_down").text(--cnt);
				// (1)stop counter when less than 0, (2)hide warning when achieved 0, (3)add another alert to block user action if network unreachable
				if (cnt<=0) {
					clearInterval(h_cntd);	
					jAlert("You have been logged out due to inactivity!");
					location.href="home_loggedout.jst";
				}
			}, 1000);
			// use jAlert instead of alert, or it will not auto log out untill OK pressed!
			jAlert('Press <b>OK</b> to continue session. Otherwise you will be logged out in <span id="count_down" class="count_down_style" color: red;">'+cnt+'</span> seconds!'
			, 'You are being logged out due to inactivity!'
			, function(){
				clearInterval(h_cntd);
			});
		}
		, jsInactTimeout);
	}).trigger("click");
	
	// show pop-up info when focus
	$("#status a").focus(function() {
		$(this).mouseenter();
	});
	
	// disappear previous pop-up
	$("#status a").blur(function() {
		$(".tooltip").hide();
	});

}, 100);

</script>


<ul id="userToolbar" class="on">
	<li class="first-child"> Hi cusadmin</li>
	<li class="toolbar_style">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<a href="home_loggedout.jst" tabindex="0">Logout</a></li>
	<li class="toolbar_style">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<a href="password_change.jst" tabindex="0">Change Password</a></li>
</ul>

<ul id="status">
	<li id="sta_batt" class="battery first-child"><div class="sprite_cont"><span class="bat-0" ><img src="./cmn/img/icn_battery.png"  alt="Battery icon" title="Battery icon" /></span></div><a role="toolbar" href="javascript: void(0);" tabindex="0">0%</a>	 <!-- NOTE: When this value changes JS will set the battery icon -->	</li><li id="sta_inet" class="internet"><span class="value on-off sprite_cont"><img src="./cmn/img/icn_on_off.png" alt="Internet Online" /></span><a href="javascript: void(0);" tabindex="0">Internet<div class="tooltip">Loading...</div></a></li><li id="sta_wifi" class="wifi"><span class="value on-off sprite_cont"><img src="./cmn/img/icn_on_off.png" alt="WiFi Online" /></span><a href="javascript: void(0);" tabindex="0">Wi-Fi<div class="tooltip">Loading...</div></a></li><li id="sta_fire" class="security last off"><span class="value on-off sprite_cont"><img src="./cmn/img/icn_on_off.png" alt="Security Off" /></span><a href="javascript: void(0);" tabindex="0"><span>Low Security</span><div class="tooltip">Loading...</div></a></li>
</ul>


</div><!-- end #sub-header -->

<!-- $Id: nav.dory.jst 3155 2010-01-06 19:36:01Z slemoine $ -->

<!--Nav-->
<div id="nav"><ul><li class="nav-gateway"><a role="menuitem"  title="click to toggle sub menu" class="top-level" href="at_a_glance.jst">Gateway</a><ul><li class="nav-at-a-glance"><a role="menuitem"  href="at_a_glance.jst">At a Glance</a></li><li class="nav-initial-setup"><a role="menuitem"  href="initial_setup.jst">Initial Setup</a></li><li class="nav-connection"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">Connection</a><ul><li class="nav-connection-status"><a role="menuitem"  href="connection_status.jst">Status</a></li><li class="nav-comcast-network"><a role="menuitem"  href="comcast_network.jst">Comcast Network</a></li><li class="nav-local-ip-network"><a role="menuitem"  href="local_ip_configuration.jst">Local IP Network</a></li><li class="nav-wifi-config"><a role="menuitem"  href="wireless_network_configuration.jst">Wi-Fi</a></li><li class="nav-mta"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">MTA</a><ul class="nav_style"><li class="nav-line-status"><a role="menuitem"  href="mta_Line_Status.jst">Status</a></li></ul></li></ul></li><li class="nav-firewall"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">Firewall</a>			<ul>				<li class="nav-firewall-ipv4"><a role="menuitem"  href="firewall_settings_ipv4.jst">IPv4</a></li>				<li class="nav-firewall-ipv6"><a role="menuitem"  href="firewall_settings_ipv6.jst">IPv6</a></li>			</ul>			</li><li class="nav-software"><a role="menuitem"  href="software.jst">Software</a></li><li class="nav-hardware"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">Hardware</a><ul><li class="nav-system-hardware"><a role="menuitem"  href="hardware.jst">System Hardware</a></li><li class="nav-battery"><a role="menuitem"  href="battery.jst">Battery</a></li><li class="nav-lan"><a role="menuitem"  href="lan.jst">LAN</a></li><li class="nav-wifi"><a role="menuitem"  href="wifi.jst">Wireless</a></li></ul></li></ul></li><li class="nav-connected-devices"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="connected_devices_computers.jst">Connected Devices</a><ul><li class="nav-cdevices"><a role="menuitem"  href="connected_devices_computers.jst">Devices</a></li></ul></li><li class="nav-content-control"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="managed_sites.jst">Content Filtering</a><ul><li class="nav-sites"><a role="menuitem"  href="managed_sites.jst">Managed Sites</a></li><li class="nav-services"><a role="menuitem"  href="managed_services.jst">Managed Services</a></li><li class="nav-devices"><a role="menuitem"  href="managed_devices.jst">Managed Devices</a></li><li class="nav-parental-reports"><a role="menuitem"  href="parental_reports.jst">Reports</a></li></ul></li><li class="nav-advanced"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="port_forwarding.jst">Advanced</a><ul><li class="nav-port-forwarding"><a role="menuitem"  href="port_forwarding.jst">Port Forwarding</a></li><li class="nav-port-triggering"><a role="menuitem"  href="port_triggering.jst">Port Triggering</a></li><li class="nav-port-management"><a role="menuitem"  href="port_management.jst">Port Management</a></li><li class="nav-remote-management"><a role="menuitem"  href="remote_management.jst">Remote Management</a></li><!--li class="nav-qos1"><a role="menuitem"  href="qos1.jst">QoS</a></li--><li class="nav-dmz"><a role="menuitem"  href="dmz.jst">DMZ</a></li><li class="nav-nat"><a role="menuitem"  href="nat.jst">NAT</a></li><li class="nav-staticrouting"><a role="menuitem"  href="staticrouting.jst">Static Routing</a></li><li class="nav-device-discovery"><a role="menuitem"  href="device_discovery.jst">Device Discovery</a></li></ul></li><li class="nav-troubleshooting"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="troubleshooting_logs.jst">Troubleshooting</a><ul><li class="nav-logs"><a role="menuitem"  href="troubleshooting_logs.jst">Logs</a></li><li class="nav-diagnostic-tools"><a role="menuitem"  href="network_diagnostic_tools.jst">Diagnostic Tools</a></li><li class="nav-restore-reboot"><a role="menuitem"  href="restore_reboot.jst">Reset/Restore Gateway</a></li><li class="nav-password"><a role="menuitem"  href="password_change.jst">Change Password</a></li></ul></li></ul></div>

<script type="text/javascript">
$(document).ready(function() {
	comcast.page.init("Advanced > Remote Management", "nav-remote-management");
	$("label").addClass("label_style");
	var HTTPS = false;
	var HTTPSPORT = "8181";
	var TELNET = false;
	var SSH = false;
	var passCheck = "Default_PWD";

	$("#https_switch").radioswitch({
		id: "https-switch",
		radio_name: "https",
		id_on: "https_enabled",
		id_off: "https_disabled",
		title_on: "Enable HTTPS",
		title_off: "Disable HTTPS",
		state: HTTPS ? "on" : "off"
	}).change(function() {
		$("#https").val(HTTPSPORT);
		validator.element("#https");
		var isUHTTPsDisabled = $(this).radioswitch("getState").on === false;
		if(isUHTTPsDisabled) {
			document.getElementById('https').disabled = true;
			remote_access_allowe();
		} else {
			// document.getElementById('https').disabled = false;
			if(("cusadmin" == "cusadmin") && (passCheck=="Default_PWD")){
				jConfirm(
				"WARNING: You have logged in with default password. Please change your password to  continue enabling Remote Management."
				,"Confirm:"
				,function(ret) {
					if(ret) {
						location.href = "password_change.jst";
						$("#https_switch").radioswitch("doSwitch", "off");
					}
					else{
						$("#https_switch").radioswitch("doSwitch", "off");
					}
				}
				);
			}else{
				jConfirm(
				"WARNING: Enabling Remote Management will expose your Gateway GUI to Internet. Your Gateway will only be protected by your logon password. Are you sure you want to continue?"
				,"Confirm:"
				,function(ret) {
					if(ret) {
						document.getElementById('https').disabled = false;
						remote_access_allowe();
					}
					else{
						$("#https_switch").radioswitch("doSwitch", "off");
					}
				}
				);
			}
		}
	});
	$("#https").val(HTTPSPORT).prop("disabled", !HTTPS);

	$("#telnet1_switch").radioswitch({
		id: "telnet1-switch",
		radio_name: "telnet1",
		id_on: "telnet1_enabled",
		id_off: "telnet1_disabled",
		title_on: "Enable Telnet",
		title_off: "Disable Telnet",
		state: TELNET ? "on" : "off"
	}).change(function() {
		var isUTELDisabled = $(this).radioswitch("getState").on === false;
		if(isUTELDisabled) {
			//document.getElementById('telnet').disabled = true;
		} else {
			//document.getElementById('telnet').disabled = false;
		}
	});

	$("#ssh1_switch").radioswitch({
		id: "ssh1-switch",
		radio_name: "ssh1",
		id_on: "ssh1_enabled",
		id_off: "ssh1_disabled",
		title_on: "Enable SSH",
		title_off: "Disable SSh",
		state: SSH ? "on" : "off"
	}).change(function() {
		var isUSSHDisabled = $(this).radioswitch("getState").on === false;
		if(isUSSHDisabled) {
			//document.getElementById('ssh').disabled = true;
		} else {
			//document.getElementById('ssh').disabled = false;
		}
	});

var ALLOWTYPE=$('input[name="single"]:radio:checked').val();
switch (ALLOWTYPE) {
	case "single":
		var STARTIP=$("#ip_address_1").val()+"."+$("#ip_address_2").val()+"."+$("#ip_address_3").val()+"."+$("#ip_address_4").val();
		var ENDIP=STARTIP;
	break;
	case "range":
		var STARTIP=$("#rangeip_address_1").val()+"."+$("#rangeip_address_2").val()+"."+$("#rangeip_address_3").val()+"."+$("#rangeip_address_4").val();
		var ENDIP=$("#endip_address_1").val()+"."+$("#endip_address_2").val()+"."+$("#endip_address_3").val()+"."+$("#endip_address_4").val();
	break;
	case "any":
		var START="notset";
		var ENDIP="notset";
	break;
}

/*********************
$("#snmp-switch").change(function() {
	var isUSNMPDisabled = $("#snmp_disabled").is(":checked");
	if(isUSNMPDisabled) {
		document.getElementById('snmp').disabled = true;
	} else {
		document.getElementById('snmp').disabled = false;
	}
});
**********************/
$("input[name='single']").click(function() {
    if($(this).val() == "range") {
	   	$("#ip_address_1").prop("disabled", true);
    	$("#ip_address_2").prop("disabled", true);
	    $("#ip_address_3").prop("disabled", true);
    	$("#ip_address_4").prop("disabled", true);
    	$("#rangeip_address_1").prop("disabled", false);
	   	$("#rangeip_address_2").prop("disabled", false);
	    $("#rangeip_address_3").prop("disabled", false);
	   	$("#rangeip_address_4").prop("disabled", false);
		$("#endip_address_1").prop("disabled", false);
	   	$("#endip_address_2").prop("disabled", false);
       	$("#endip_address_3").prop("disabled", false);
	   	$("#endip_address_4").prop("disabled", false);
		$("[id^='ipv6_']").prop("disabled", true);
		$("[id^='rangeipv6_']").prop("disabled", false);
		$("[id^='endipv6_']").prop("disabled", false);
 	} else if($(this).val() == "single") {
    	$("#ip_address_1").prop("disabled", false);
	   	$("#ip_address_2").prop("disabled", false);
       	$("#ip_address_3").prop("disabled", false);
	   	$("#ip_address_4").prop("disabled", false);
    	$("#rangeip_address_1").prop("disabled", true);	
	   	$("#rangeip_address_2").prop("disabled", true);
	    $("#rangeip_address_3").prop("disabled", true);
	   	$("#rangeip_address_4").prop("disabled", true);
		$("#endip_address_1").prop("disabled", true);
	   	$("#endip_address_2").prop("disabled", true);
       	$("#endip_address_3").prop("disabled", true);
	   	$("#endip_address_4").prop("disabled", true);
		$("[id^='ipv6_']").prop("disabled", false);
		$("[id^='rangeipv6_']").prop("disabled", true);
		$("[id^='endipv6_']").prop("disabled", true);
	} else {
		$("#ip_address_1").prop("disabled", true);
	   	$("#ip_address_2").prop("disabled", true);
       	$("#ip_address_3").prop("disabled", true);
	   	$("#ip_address_4").prop("disabled", true);
    	$("#rangeip_address_1").prop("disabled", true);
	   	$("#rangeip_address_2").prop("disabled", true);
	    $("#rangeip_address_3").prop("disabled", true);
	   	$("#rangeip_address_4").prop("disabled", true);
		$("#endip_address_1").prop("disabled", true);
	   	$("#endip_address_2").prop("disabled", true);
       	$("#endip_address_3").prop("disabled", true);
	   	$("#endip_address_4").prop("disabled", true);
		$("[id^='ipv6_']").prop("disabled", true);
		$("[id^='rangeipv6_']").prop("disabled", true);
		$("[id^='endipv6_']").prop("disabled", true);
	}
});

jQuery.validator.addMethod("ip",function(value,element){
	var id=$(element).attr("id").split("_")[2];
	return this.optional(element) || (value.match(/^\d+$/g) && (id==1?value>0:value >= 0) && (id==4?value<255:value <= 255));
}, "Please enter a valid IP address.");

jQuery.validator.addMethod("rangeip",function(value,element){
	var id=$(element).attr("id").split("_")[2];
	var s=0, e=0;
	for(var i=1; i<=id; i++){
		s=s*256+parseInt($("#rangeip_address_"+i).val());
		e=e*256+parseInt($("#endip_address_"+i).val());
	}
	return this.optional(element) || (id==4?s<e:s<=e) ;
}, "Please enter valid IP address (Note: Start IP must be less than end IP !)");

jQuery.validator.addMethod("port",function(value,element){
	return this.optional(element) || (value.match(/^\d+$/g) && value >= 1025 && value <= 65535);
}, "Please enter a port number 1025 ~ 65535.");

jQuery.validator.addMethod("notEqual",function(value,element){
	return this.optional(element) || (value != $('#http').val());
}, "Please enter a different port.");

var validator = $("#pageForm").validate({
	groups:{
		ip_address_x:		"ip_address_1 ip_address_2 ip_address_3 ip_address_4",
		rangeip_address_x:	"rangeip_address_1 rangeip_address_2 rangeip_address_3 rangeip_address_4",
		endip_address_x:	"endip_address_1 endip_address_2 endip_address_3 endip_address_4",
		ipv6_address_x:		"ipv6_address_1 ipv6_address_2 ipv6_address_3 ipv6_address_4 ipv6_address_5 ipv6_address_6 ipv6_address_7 ipv6_address_8",
		rangeipv6_address_x:"rangeipv6_address_1 rangeipv6_address_2 rangeipv6_address_3 rangeipv6_address_4 rangeipv6_address_5 rangeipv6_address_6 rangeipv6_address_7 rangeipv6_address_8",
		endipv6_address_x:	"endipv6_address_1 endipv6_address_2 endipv6_address_3 endipv6_address_4 endipv6_address_5 endipv6_address_6 endipv6_address_7 endipv6_address_8"
	},
	rules: {
		https:{
			required: function(element){return !$(element).prop("disabled")},
			port: true,
			notEqual: true
		},
		ip_address_1:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		ip_address_2:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		ip_address_3:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		ip_address_4:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		rangeip_address_1:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		rangeip_address_2:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		rangeip_address_3:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		rangeip_address_4:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true
		},
		endip_address_1:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true,
			rangeip: true
		},
		endip_address_2:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true,
			rangeip: true
		},
		endip_address_3:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true,
			rangeip: true
		},
		endip_address_4:{
			required: function(element){return !$(element).prop("disabled")},
			ip: true,
			rangeip: true
		},
//for IPv6 validation
		ipv6_address_1:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_2:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_3:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_4:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_5:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_6:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_7:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		ipv6_address_8:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_1:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_2:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_3:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_4:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_5:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_6:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_7:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		rangeipv6_address_8:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_1:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_2:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_3:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_4:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_5:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_6:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_7:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		},
		endipv6_address_8:{
			required: function(element){return !$(element).prop("disabled")},
			hexadecimal: true,
		}
	}
	,highlight: function( element, errorClass, validClass ) {
		$(element).closest(".form-row").find("input").addClass(errorClass).removeClass(validClass);
	}
	,unhighlight: function( element, errorClass, validClass ) {
		$(element).closest(".form-row").find("input").removeClass(errorClass).addClass(validClass);
	}
});

$("#https").keydown(function(){	validator.element($(this)); });

// $(":text").val("");
var snetCal = {

	getsnetRange : function( ip, snetMask )
	{
		var ipNum = snetCal.toDeci( ip );
		var snetMaskNum = snetCal.toDeci( snetMask );
	
		var prefix = 0;
		var newPrefix = 0;
		var prefixSize;
	
		for( prefixSize = 0; prefixSize < 32; prefixSize++ )
		{
			newPrefix = ( prefix + ( 1 << ( 32 - ( prefixSize + 1 ) ) ) ) >>> 0;
		
			if( ( ( snetMaskNum & newPrefix ) >>> 0 ) !== newPrefix )
			{
				break;
			}
		
			prefix = newPrefix;		
		} 
		
		return snetCal.getMaskRange( ipNum, prefixSize );		 
	},

	getMaskRange : function( ipNum, prefixSize )
	{
		var prefixMask = snetCal.getPrefixMask( prefixSize );
		var lowMask = snetCal.getMask( 32 - prefixSize );
		
		var ipLow = ( ipNum & prefixMask ) >>> 0;
		var ipHigh = ( ( ( ipNum & prefixMask ) >>> 0 ) + lowMask ) >>> 0;
		
		return {
			'ipLow'		: snetCal.toStr( ipLow ),
			'ipHigh'	: snetCal.toStr( ipHigh )
		};
	},

	getPrefixMask : function( prefixSize )
	{
		var mask = 0;
		var i;
		
		for( i = 0; i < prefixSize; i++ )
		{
			mask += ( 1 << ( 32 - ( i + 1 ) ) ) >>> 0;
		}
		
		return mask;
	},
	
	getMask : function( maskSize )
	{
		var mask = 0;
		var i;
		
		for( i = 0; i < maskSize; i++ )
		{
			mask += ( 1 << i ) >>> 0;
		}
		
		return mask;
	},
	
	toDeci : function( ipString )
	{
		var d = ipString.split( '.' );
		return ( ( ( ( ( ( +d[ 0 ] ) * 256 ) + ( +d [ 1 ] ) ) * 256 ) + ( +d[ 2 ] ) ) * 256 ) + ( +d[ 3 ] );
	},
	
	toStr : function( ipNum )
	{	
		var d = ipNum % 256;
		
		for( var i = 3; i > 0; i-- )
		{ 
			ipNum   = Math.floor( ipNum / 256 );
			d       = ipNum % 256 + '.' + d;
		}
		
		return d;
	}
};
$(".btn").click(function(){
        var token = "dauz8cauea";
	var isValid = true;
	$("p.error").remove();

	var https_enabled = $("#https_switch").radioswitch("getState").on;

	if(https_enabled){
		if ($(":radio[value='single']").prop("checked")){
			if (IsBlank("ip_address_") && IsBlank("ipv6_address_")){
				jAlert("Please input at least one single address of IPv4 or IPv6!");
				isValid = false;
			}
			else if (IsBlank("ip_address_")){		
				$("[id^='ipv6_address_']").each(function(){
					if (!validator.element($(this))){
						isValid = false;	//any invalid will make this false
					}
				});	
			}
			else if (IsBlank("ipv6_address_")){
				$("[id^='ip_address_']").each(function(){
					if (!validator.element($(this))){
						isValid = false;	//any invalid will make this false
					}
				});			
			}
			else {
				if(!$("#pageForm").valid()){
					isValid = false;
				}
			}
		}
		else if ($(":radio[value='range']").prop("checked")){
			if (IsBlank("rangeip_address_") && IsBlank("endip_address_") && IsBlank("rangeipv6_address_") && IsBlank("endipv6_address_")){
				jAlert("Please input at least one range address of IPv4 or IPv6!");
				isValid = false;
			}
			else if (IsBlank("rangeip_address_") && IsBlank("endip_address_")){		
				$("[id^='rangeipv6_address_'],[id^='endipv6_address_']").each(function(){
					if (!validator.element($(this))){
						isValid = false;	//any invalid will make this false
					}
				});	
			}
			else if (IsBlank("rangeipv6_address_") && IsBlank("endipv6_address_")){		
				$("[id^='rangeip_address_'],[id^='endip_address_']").each(function(){
					if (!validator.element($(this))){
						isValid = false;	//any invalid will make this false
					}
				});	
			}
			else {
				if(!$("#pageForm").valid()){
					isValid = false;
				}
			}	
		}
		else {
			if(!$("#pageForm").valid()){
				isValid = false;
			}
		}
	
		if (!isValid) return;
	}
/*
	//This condition check is not a must have requirement and is disabled on the residential UI repo as well
	if ($("#telnet1_switch").radioswitch("getState").on && $("#ssh1_switch").radioswitch("getState").on)
	{
		jAlert("Telnet and SSH can not be enabled at the same time.\r\nPlease disable at least one of them.");
		return;
	}
*/	
	var telnet = $("#telnet1_switch").radioswitch("getState").on;
	if (TELNET==telnet) telnet="notset";
	var ssh ="notset";

	var https = $("#https_switch").radioswitch("getState").on;
	if (HTTPS==https) https="notset";
	var httpsport=$('#https').val();
	// if (HTTPSPORT==httpsport || HTTPS=="false") httpsport="notset";
	if (HTTPSPORT==httpsport) httpsport="notset";

	if(!https){
		allowtype	="notset";
		startIP		="notset";
		endIP		="notset";
		startIPv6	="notset";
		endIPv6		="notset";
	} else {
		var allowtype=$('input[name="single"]:radio:checked').val();
		switch (allowtype) {
			case "single":
				var startIP=$("#ip_address_1").val()+"."+$("#ip_address_2").val()+"."+$("#ip_address_3").val()+"."+$("#ip_address_4").val();
				var endIP=startIP;
				var startIPv6	= GetAddress(":", "ipv6_address_");
				var endIPv6		= startIPv6;
				if (IsBlank("ip_address_")){
					startIP = endIP = "255.255.255.255";
				}
				if (IsBlank("ipv6_address_")){
					startIPv6 = endIPv6 = "x";
				}
			break;
			case "range":
				var startIP=$("#rangeip_address_1").val()+"."+$("#rangeip_address_2").val()+"."+$("#rangeip_address_3").val()+"."+$("#rangeip_address_4").val();
				var endIP=$("#endip_address_1").val()+"."+$("#endip_address_2").val()+"."+$("#endip_address_3").val()+"."+$("#endip_address_4").val();
				var startIPv6	= GetAddress(":", "rangeipv6_address_");
				var endIPv6		= GetAddress(":", "endipv6_address_");
				if (IsBlank("rangeip_address_")){
					startIP = endIP = "255.255.255.255";
				}
				if (IsBlank("rangeipv6_address_")){
					startIPv6 = endIPv6 = "x";
				}
			break;
			case "any":
				var startIP="notset";
				var endIP="notset";
				var startIPv6	= "notset";
				var endIPv6		= "notset";
			break;
		}
		if (ALLOWTYPE==allowtype) {
			allowtype="notset";
			if (STARTIP==startIP) startIP="notset";
			if (ENDIP==endIP) endIP="notset";
		} else {
			if (allowtype=="any") allowtype=true;
			else allowtype=false;
		}

		var ipv4_gw 	= "10.1.10.1";
		var ipv4_smask 	= "255.255.255.0";
		var lanRange 	= snetCal.getsnetRange( ipv4_gw, ipv4_smask );
		var ipv4_rhigh 	= lanRange["ipHigh"];
		var ipv4_rlow 	= lanRange["ipLow"];

		var allowtype_Compare=$('input[name="single"]:radio:checked').val();
		var startIP_single=$("#ip_address_1").val()+"."+$("#ip_address_2").val()+"."+$("#ip_address_3").val()+"."+$("#ip_address_4").val();
		var startIP_Compare=$("#rangeip_address_1").val()+"."+$("#rangeip_address_2").val()+"."+$("#rangeip_address_3").val()+"."+$("#rangeip_address_4").val();
		var endIP_Compare=$("#endip_address_1").val()+"."+$("#endip_address_2").val()+"."+$("#endip_address_3").val()+"."+$("#endip_address_4").val();

	/*	if(allowtype_Compare == "single"){
			if( (snetCal.toDeci(startIP_single) > snetCal.toDeci(ipv4_rlow)) && (snetCal.toDeci(startIP_single) < snetCal.toDeci(ipv4_rhigh)) ){
				jAlert("Invalid IPv4 Address.");
				return;
			}
		}else if(allowtype_Compare == "range"){
			if( (snetCal.toDeci(startIP_Compare) > snetCal.toDeci(ipv4_rlow)) && (snetCal.toDeci(startIP_Compare) < snetCal.toDeci(ipv4_rhigh)) ){
				jAlert("Invalid IPv4 Start Address.");
				return;
			}
			if( (snetCal.toDeci(endIP_Compare) > snetCal.toDeci(ipv4_rlow)) && (snetCal.toDeci(endIP_Compare) < snetCal.toDeci(ipv4_rhigh)) ){
				jAlert("Invalid IPv4 End Address.");
				return;
			}
				
		}*/
	}

	// if($("#pageForm").valid()) {	
		jProgress('This will take several seconds!', 60);
		$.ajax({
			type:"POST",
			url:"actionHandler/ajax_remote_management.jst",
			data:{https:https, httpsport:httpsport,
					allowtype:allowtype, startIP:startIP, endIP:endIP,
					telnet:telnet, ssh:ssh, startIPv6:startIPv6, endIPv6:endIPv6,
					csrfp_token: token
					/*
					mso_mgmt:$("#mso_mgmt").prop("checked"),
					cus_mgmt:$("#cus_mgmt").prop("checked")
					*/
					},
			success:function(){
				setTimeout(function(){
					jHide();
				    window.location.href="remote_management.jst";
				}, 15000);			
			},
			error:function(){
				setTimeout(function(){
					jHide();
					/*if (http!="notset" && httpport!="notset") {
						jAlert("Something wrong, please try later!");
					} else {
						window.location.href="remote_management.jst";
					}*/
				}, 15000);
			}
		});
	// }
});

function IsBlank(id_prefix){
	var ret = true;
	$('[id^="'+id_prefix+'"]').each(function(){
		if ($(this).val().replace(/\s/g, '') != ""){
			ret = false;
		}
	});
	return ret;
}

function GetAddress(separator, id_prefix){
	var ret = "";
	$('[id^="'+id_prefix+'"]').each(function(){
		ret = ret + $(this).val() + separator;
	});
	return ret.replace(eval('/'+separator+'$/'), '');
}

	if ("cusadmin" == "cusadmin"){
		$(".div_global").hide();
	}
	else if ("admin" == "cusadmin"){
		$(".div_global").hide();
	}

function remote_access_block(){
	$("#single, #range, #any").attr('disabled', true);

	$("#ip_address_1").prop("disabled", true);
   	$("#ip_address_2").prop("disabled", true);
	$("#ip_address_3").prop("disabled", true);
   	$("#ip_address_4").prop("disabled", true);
	$("#rangeip_address_1").prop("disabled", true);
   	$("#rangeip_address_2").prop("disabled", true);
    	$("#rangeip_address_3").prop("disabled", true);
   	$("#rangeip_address_4").prop("disabled", true);
	$("#endip_address_1").prop("disabled", true);
   	$("#endip_address_2").prop("disabled", true);
	$("#endip_address_3").prop("disabled", true);
   	$("#endip_address_4").prop("disabled", true);
	$("[id^='ipv6_']").prop("disabled", true);
	$("[id^='rangeipv6_']").prop("disabled", true);
	$("[id^='endipv6_']").prop("disabled", true);
	
	$("#message_note").show();
}

	$("#message_note").hide();

	if(!HTTPS){remote_access_block();}
	function remote_access_allowe(){
		var https_enabled = $("#https_switch").radioswitch("getState").on;
		var allowtype	  =$('input[name="single"]:radio:checked').val();

		if(https_enabled){
			$("#message_note").hide();
			$("#"+allowtype).trigger("click");
			$("#single, #range, #any").attr('disabled', false);
		} else {
		remote_access_block();
		}
	}

});
</script>
<div id="content">
	<h1>Advanced > Remote Management</h1>
	<div id="educational-tip">
        <p class="tip">Remote Management allows the gateway to be remotely accessed by a customer account representative to perform troubleshooting or maintenance.</p>
	    <p class="hidden">Remote Management can be used via HTTPS.</p>
		<p class="hidden">Enable the HTTPS option and enter the value for HTTPS Port, then you can access your device from HTTPS. For example, if the WAN IP address is 11.22.11.22 and the HTTPS port number is 8181, then you would use https://11.22.11.22:8181</p>
		<p class="hidden">Select whether you would like to have Remote Management open to all Internet IP Addresses, an Internet IP Address range, or a single Internet IP Address.</p>
	</div>
	<form method="" id="pageForm" action="">
	<div class="module forms">
		<h2>Remote Management</h2>

		<div class="form-row ">
			<label for="https">HTTPS: <input type="text" value="" name="https" maxlength="5" size=7 id="https" /></label>
			<span id="https_switch"></span>
        </div>
		<div class="form-row">
			<p class="remote_https"><strong>
			
			Remote Management Address (IPv4): 
			71.239.230.253
			<br/>
			Remote Management Address (IPv6): 		
					
			</strong></p>
		</div>
		<p  id="message_note" class="remote_enable error">Please enable HTTPS to configure Remote Access Allowed From.</p>
	</div> <!-- end .module -->
	<div class="module forms">
	    <h2>Remote Access Allowed From</h2><br/>
		
		<h3><input type="radio"  name="single" value="single" id="single" /><label class="acs-hide" for="single"></label><b>Single Computer</b><br/></h3>
		<div class="form-row">
			<label for="ip_address_1">IPv4 Address:</label>
			 <input type="text" size="5" maxlength="3"  id="ip_address_1" name="ip_address_1"  disabled="disabled"/><label for="ip_address_2" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="ip_address_2" name="ip_address_2"  disabled="disabled"/><label for="ip_address_3" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="ip_address_3" name="ip_address_3"  disabled="disabled"/><label for="ip_address_4" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="ip_address_4" name="ip_address_4"  disabled="disabled" />
		</div>
		<!--IPv6 disabled-->
		<div class="form-row">
			<label for="ipv6_address_1">IPv6 Address:</label>
			 <input type="text" name="ipv6_address_1" id="ipv6_address_1" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_2" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_2" id="ipv6_address_2" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_3" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_3" id="ipv6_address_3" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_4" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_4" id="ipv6_address_4" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_5" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_5" id="ipv6_address_5" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_6" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_6" id="ipv6_address_6" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_7" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_7" id="ipv6_address_7" maxlength="4" class="ipv6-input" disabled="disabled" /><label for="ipv6_address_8" class="acs-hide"></label>
			:<input type="text" name="ipv6_address_8" id="ipv6_address_8" maxlength="4" class="ipv6-input" disabled="disabled" />						
		</div>
	    <h3> <input type="radio"  name="single" value="range" id="range" /><label for="range" class="acs-hide"></label><b>Range Of IPs</b></h3>
		<div class="form-row">
		    <label for="rangeip_address_1">Start IPv4 Address:</label>
		     <input type="text" size="5" maxlength="3"  id="rangeip_address_1" name="rangeip_address_1" disabled="disabled" /><label for="rangeip_address_2" class="acs-hide"></label>
		    .<input type="text" size="5" maxlength="3"  id="rangeip_address_2" name="rangeip_address_2" disabled="disabled" /><label for="rangeip_address_3" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="rangeip_address_3" name="rangeip_address_3" disabled="disabled" /><label for="rangeip_address_4" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="rangeip_address_4" name="rangeip_address_4" disabled="disabled" />
		</div>
		<div class="form-row">
		    <label for="endip_address_1">End IPv4 Address:</label>
			 <input type="text" size="5" maxlength="3"  id="endip_address_1" name="endip_address_1"  disabled="disabled"/><label for="endip_address_2" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="endip_address_2" name="endip_address_2"  disabled="disabled"/><label for="endip_address_3" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="endip_address_3" name="endip_address_3"  disabled="disabled"/><label for="endip_address_4" class="acs-hide"></label>
			.<input type="text" size="5" maxlength="3"  id="endip_address_4" name="endip_address_4"  disabled="disabled"/>
		</div>
		<!--IPv6 Start-End disabled-->
		<div class="form-row">
			<label for="rangeipv6_address_1">Start IPv6 Address:</label>
			 <input type="text" disabled="disabled" name="rangeipv6_address_1" id="rangeipv6_address_1" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_2" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_2" id="rangeipv6_address_2" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_3" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_3" id="rangeipv6_address_3" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_4" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_4" id="rangeipv6_address_4" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_5" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_5" id="rangeipv6_address_5" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_6" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_6" id="rangeipv6_address_6" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_7" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_7" id="rangeipv6_address_7" maxlength="4" class="ipv6-input"><label for="rangeipv6_address_8" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="rangeipv6_address_8" id="rangeipv6_address_8" maxlength="4" class="ipv6-input">							
		</div>
		<div class="form-row">
			<label for="endipv6_address_1">End IPv6 Address:</label>
			 <input type="text" disabled="disabled" name="endipv6_address_1" id="endipv6_address_1" maxlength="4" class="ipv6-input"><label for="endipv6_address_2" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_2" id="endipv6_address_2" maxlength="4" class="ipv6-input"><label for="endipv6_address_3" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_3" id="endipv6_address_3" maxlength="4" class="ipv6-input"><label for="endipv6_address_4" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_4" id="endipv6_address_4" maxlength="4" class="ipv6-input"><label for="endipv6_address_5" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_5" id="endipv6_address_5" maxlength="4" class="ipv6-input"><label for="endipv6_address_6" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_6" id="endipv6_address_6" maxlength="4" class="ipv6-input"><label for="endipv6_address_7" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_7" id="endipv6_address_7" maxlength="4" class="ipv6-input"><label for="endipv6_address_8" class="acs-hide"></label>
			:<input type="text" disabled="disabled" name="endipv6_address_8" id="endipv6_address_8" maxlength="4" class="ipv6-input">							
		</div>
		<h3><input type="radio"  name="single" value="any" id="any" checked="checked" /><label for="any" class="acs-hide"></label><b>Any Computer</b></h3>
		
		<div>
			<p> Note: This option will allow any computer on the Internet to access your network and may cause a security risk.</p>
		</div>
	</div>
	
	<div class="form-btn">
		<input type="button" value="Save" class="btn" />
	</div>
    
	</form>
</div><!-- end #content -->

<!-- $Id: footer.jst 2976 2009-09-02 21:42:51Z cporto $ -->
		</div> <!-- end #main-content-->
		
		<!--Footer-->
		<div id="footer">
			<ul id="footer-links" class="hidden">
				<li class="first-child"><a href="http://www.xfinity.com" target="_blank">Xfinity.com</a></li>
				<li class="footer_style">&#8226;&nbsp;&nbsp;<a href="https://customer.comcast.com/" target="_blank">customerCentral</a></li>
				<li class="footer_style">&#8226;&nbsp;&nbsp;<a href="http://customer.comcast.com/userguides" target="_blank">User Guide</a></li>
			</ul>
		</div> <!-- end #footer -->
	</div> <!-- end #container -->
<script type="text/javascript">
$(document).ready(function() {
	// focus current page link, must after page.init()
	//$('#nav [href="'+location.href.replace(/^.*\//g, '')+'"]').focus();		// need a "skip nav" function
	$("#skip-link").click(function () {
        $('#content').attr('tabIndex', -1).focus();  //this is to fix skip-link doesn't work on webkit-based Chrome
    });

	// change radio-btn status and do ajax when press "enter"
	//$(".radio-btns a").keydown(function(event){
	$(".radio-btns a").keypress(function(event){
		var keycode = (event.keyCode ? event.keyCode : event.which);
		if(13 == keycode){
			if (!$(this).parent(".radio-btns").find("li").hasClass("selected")){
				return;		// do nothing if has disabled class, don't detect disabled attr for radio-btn
			}
			// console.log($(this).find(":radio").hasClass("disabled"));
			$(this).find(":radio").trigger('click');
			$(this).find(":radio").trigger('change');
			$(this).parent(".radio-btns").radioToButton();
		}
	});
	
	// press Esc to skip menu and goto first control of content
	// Esc:keypress:which is zero in FF, Esc:keypress is not work in Chrome
	$("#nav").keydown(function(event){
		var keycode = (event.keyCode ? event.keyCode : event.which);
		if(27 == keycode){
			$("#content textarea:eq(0)").focus();
			$("#content input:eq(0)").focus();
			$("#content a:eq(0)").focus();			// high priority element to focus			
		}
		// alert(event.keyCode+"---"+event.which+"---"+event.charCode);		
	});
	
	/* changes for high contrast mode */
	$.highContrastDetect({useExtraCss: true, debugInNormalMode: false});
	if ($.__isHighContrast) {
		/* change plus/minus tree indicator of nav menu */
		$("#nav a.top-level").prepend('<span class="hi_nav_top_indi">[+]</span>');
		$("#nav a.folder").prepend('<span class="hi_nav_folder_indi">[+]</span>');
		$("#nav a.top-level-active span.hi_nav_top_indi").text("[-]");
		$("#nav a.folder").click(function() {
			/* this should be called after nav state changed */
			var $link = $(this);
			if ($link.hasClass("folder-open")) {
				$link.children("span.hi_nav_folder_indi").text("[-]");
			}
			else {
				$link.children("span.hi_nav_folder_indi").text("[+]");
			}
		});
	}

	/*
	*	these 3 sections for radio-btn accessibility, as a workaround, maybe should put at the front of .ready().
	*/
	// add "role" and "title" for ARIA, attr may need to be embedded into html
	$(".radio-btns a").each(function(){
		$(this).attr("role", "radio").attr("title", $(this).closest("ul").prev().text() + $(this).find("label").text());
	});
	
	// monitor "aria-checked" status for JAWS, NOTE: better depends on input element
	$(".radio-btns").change(function(){
		$(this).find("a").each(function(){
			$(this).attr("aria-checked", $(this).find("input").attr("checked") ? "true" : "false");
		});
	});
	
	//give the initial status, do not trigger change above
	$(".radio-btns").find("a").each(function(){
		$(this).attr("aria-checked", $(this).find("input").attr("checked") ? "true" : "false");
	});

});
</script>	
</body>
</html>


