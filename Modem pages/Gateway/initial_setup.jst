
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">




<head>
	<!--CSS-->
	<link rel="stylesheet" type="text/css" media="screen" href="./cmn/css/common-min.css" />
	<!--[if IE 6]>
	<link rel="stylesheet" type="text/css" href="./cmn/css/ie6-min.css" />
	<![endif]-->
	<!--[if IE 7]>
	<link rel="stylesheet" type="text/css" href="./cmn/css/ie7-min.css" />
	<![endif]-->
	<link rel="stylesheet" type="text/css" media="print" href="./cmn/css/print.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="./cmn/css/lib/jquery.radioswitch.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="./cmn/css/lib/progressBar.css" />
	<!--Character Encoding-->
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta name="robots" content="noindex,nofollow">
    <script type="text/javascript" src="./cmn/js/lib/jquery-3.4.1.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/jquery-migrate-1.2.1.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/jquery.validate.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/jquery.alerts.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.ciscoExt.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.highContrastDetect.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.radioswitch.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/jquery.virtualDialog.js"></script>
	<script type="text/javascript" src="./cmn/js/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="./cmn/js/lib/bootstrap-waitingfor.js"></script>
    <!-- update the version of utilityFunctions.js if any changes is made to this js file otherwise browser will take the old js file from the cache memory -->
	<script type="text/javascript" src="./cmn/js/utilityFunctions.js?v=1"></script>
    <script type="text/javascript" src="./cmn/js/comcast.js"></script>
    
</head>
<script type="text/javascript">
	$(document).ready(function() {
		$("table.data td").each(function() {
			if($(this).text().split("\n")[0].length > 25)
			{
				$(this).closest('table').css("table-layout", "fixed");
				$(this).css("word-wrap", "break-word");
			}
		});
	});
</script>

<body>
    <!--Main Container - Centers Everything-->
	<div id="container">

		<!--Header-->
		<div id="header">
			<h2 id="logo" class="logo_title"><img src="./cmn/img/logo_xfinity.png" alt="Company logo" title="Company logo" /></h2>
			<p class="bridmar">
				<strong>
				
				</strong>
			</p>
		</div> <!-- end #header -->

		<div id='div-skip-to' class="acs-hide">
			<a id="skip-link" name="skip-link" href="#content">Skip to content</a>
		</div>
		
		<!--Main Content-->
		<div id="main-content">



<div id="sub-header">
	
<!--dynamic generate user bar icon and tips-->



<script type="text/javascript">
setTimeout(function() {
	/*
	* get status when hover or tab focused one by one
	* but for screen reader we have to load all status once
	* below code can easily rollback
	*/
	//update user bar
	//var sessionCsrf= "gz46nsh67q";
	//if(document.cookie==""){
	//	sessionStorage.setItem("Csrfp_token",sessionCsrf);
	//}
	$.ajax({
		type: "GET",
		url: "actionHandler/ajaxSet_userbar.jst",
		data: { configInfo: "noData" },
		dataType: "json",
		success: function(msg) {
			// theObj.find(".tooltip").html(msg.tips);
			for (var i=0; i<msg.tags.length; i++){
				$("#"+msg.tags[i]).find(".tooltip").html(msg.tips[i].replace(/-/g, "<br/>"));
				$("#"+msg.tags[i]).removeClass("off");
				if(msg.mainStatus[i]=="false")$("#"+msg.tags[i]).addClass("off");
				if(msg.tags[i] === "sta_fire")
				{
					if (!(("High"== msg.mainStatus[i]) || ("Medium"==msg.mainStatus[i]))) 
					{
						$("#"+msg.tags[i]).addClass("off");
					}
					$("#sta_fire a>span").text(msg.mainStatus[i] + " Security")
				}
			}
			//$sta_batt,$battery_class
			$("#sta_batt a").text(msg.mainStatus[4]+"%");
			$("#sta_batt > div > span").removeClass().addClass(msg.mainStatus[5]);
		},
		error: function(){
			// does something
		}
	});

	//when clicked on this page, restart timer
	var jsInactTimeout = parseInt("840") * 1000;
	// if ("") jsInactTimeout = 5000;	// 5 seconds debug
	
	// var h_timer = setTimeout('alert("You are being logged out due to inactivity."); location.href="home_loggedout.jst";', jsInactTimeout);
	var h_timer = null;
	$(document).click(function() {
		// do not handle click if no-login for GA
		// if ("" == "") {
			// return;
		// }			
	
		// do not handle click event when count-down show up
		if ($("#count_down").length > 0) {
			return;
		}
		// console.log(h_timer);
		
		clearTimeout(h_timer);
		h_timer = setTimeout(function(){
			var cnt		= 60;
			var h_cntd  = setInterval(function(){
				$("#count_down").text(--cnt);
				// (1)stop counter when less than 0, (2)hide warning when achieved 0, (3)add another alert to block user action if network unreachable
				if (cnt<=0) {
					clearInterval(h_cntd);	
					jAlert("You have been logged out due to inactivity!");
					location.href="home_loggedout.jst";
				}
			}, 1000);
			// use jAlert instead of alert, or it will not auto log out untill OK pressed!
			jAlert('Press <b>OK</b> to continue session. Otherwise you will be logged out in <span id="count_down" class="count_down_style" color: red;">'+cnt+'</span> seconds!'
			, 'You are being logged out due to inactivity!'
			, function(){
				clearInterval(h_cntd);
			});
		}
		, jsInactTimeout);
	}).trigger("click");
	
	// show pop-up info when focus
	$("#status a").focus(function() {
		$(this).mouseenter();
	});
	
	// disappear previous pop-up
	$("#status a").blur(function() {
		$(".tooltip").hide();
	});

}, 100);

</script>


<ul id="userToolbar" class="on">
	<li class="first-child"> Hi cusadmin</li>
	<li class="toolbar_style">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<a href="home_loggedout.jst" tabindex="0">Logout</a></li>
	<li class="toolbar_style">&nbsp;&nbsp;&#8226;&nbsp;&nbsp;<a href="password_change.jst" tabindex="0">Change Password</a></li>
</ul>

<ul id="status">
	<li id="sta_batt" class="battery first-child"><div class="sprite_cont"><span class="bat-0" ><img src="./cmn/img/icn_battery.png"  alt="Battery icon" title="Battery icon" /></span></div><a role="toolbar" href="javascript: void(0);" tabindex="0">0%</a>	 <!-- NOTE: When this value changes JS will set the battery icon -->	</li><li id="sta_inet" class="internet"><span class="value on-off sprite_cont"><img src="./cmn/img/icn_on_off.png" alt="Internet Online" /></span><a href="javascript: void(0);" tabindex="0">Internet<div class="tooltip">Loading...</div></a></li><li id="sta_wifi" class="wifi"><span class="value on-off sprite_cont"><img src="./cmn/img/icn_on_off.png" alt="WiFi Online" /></span><a href="javascript: void(0);" tabindex="0">Wi-Fi<div class="tooltip">Loading...</div></a></li><li id="sta_fire" class="security last off"><span class="value on-off sprite_cont"><img src="./cmn/img/icn_on_off.png" alt="Security Off" /></span><a href="javascript: void(0);" tabindex="0"><span>Low Security</span><div class="tooltip">Loading...</div></a></li>
</ul>


</div><!-- end #sub-header -->


<!-- $Id: nav.dory.jst 3155 2010-01-06 19:36:01Z slemoine $ -->

<!--Nav-->
<div id="nav"><ul><li class="nav-gateway"><a role="menuitem"  title="click to toggle sub menu" class="top-level" href="at_a_glance.jst">Gateway</a><ul><li class="nav-at-a-glance"><a role="menuitem"  href="at_a_glance.jst">At a Glance</a></li><li class="nav-initial-setup"><a role="menuitem"  href="initial_setup.jst">Initial Setup</a></li><li class="nav-connection"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">Connection</a><ul><li class="nav-connection-status"><a role="menuitem"  href="connection_status.jst">Status</a></li><li class="nav-comcast-network"><a role="menuitem"  href="comcast_network.jst">Comcast Network</a></li><li class="nav-local-ip-network"><a role="menuitem"  href="local_ip_configuration.jst">Local IP Network</a></li><li class="nav-wifi-config"><a role="menuitem"  href="wireless_network_configuration.jst">Wi-Fi</a></li><li class="nav-mta"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">MTA</a><ul class="nav_style"><li class="nav-line-status"><a role="menuitem"  href="mta_Line_Status.jst">Status</a></li></ul></li></ul></li><li class="nav-firewall"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">Firewall</a>			<ul>				<li class="nav-firewall-ipv4"><a role="menuitem"  href="firewall_settings_ipv4.jst">IPv4</a></li>				<li class="nav-firewall-ipv6"><a role="menuitem"  href="firewall_settings_ipv6.jst">IPv6</a></li>			</ul>			</li><li class="nav-software"><a role="menuitem"  href="software.jst">Software</a></li><li class="nav-hardware"><a role="menuitem"  title="click to toggle sub menu"  href="javascript:;">Hardware</a><ul><li class="nav-system-hardware"><a role="menuitem"  href="hardware.jst">System Hardware</a></li><li class="nav-battery"><a role="menuitem"  href="battery.jst">Battery</a></li><li class="nav-lan"><a role="menuitem"  href="lan.jst">LAN</a></li><li class="nav-wifi"><a role="menuitem"  href="wifi.jst">Wireless</a></li></ul></li></ul></li><li class="nav-connected-devices"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="connected_devices_computers.jst">Connected Devices</a><ul><li class="nav-cdevices"><a role="menuitem"  href="connected_devices_computers.jst">Devices</a></li></ul></li><li class="nav-content-control"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="managed_sites.jst">Content Filtering</a><ul><li class="nav-sites"><a role="menuitem"  href="managed_sites.jst">Managed Sites</a></li><li class="nav-services"><a role="menuitem"  href="managed_services.jst">Managed Services</a></li><li class="nav-devices"><a role="menuitem"  href="managed_devices.jst">Managed Devices</a></li><li class="nav-parental-reports"><a role="menuitem"  href="parental_reports.jst">Reports</a></li></ul></li><li class="nav-advanced"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="port_forwarding.jst">Advanced</a><ul><li class="nav-port-forwarding"><a role="menuitem"  href="port_forwarding.jst">Port Forwarding</a></li><li class="nav-port-triggering"><a role="menuitem"  href="port_triggering.jst">Port Triggering</a></li><li class="nav-port-management"><a role="menuitem"  href="port_management.jst">Port Management</a></li><li class="nav-remote-management"><a role="menuitem"  href="remote_management.jst">Remote Management</a></li><!--li class="nav-qos1"><a role="menuitem"  href="qos1.jst">QoS</a></li--><li class="nav-dmz"><a role="menuitem"  href="dmz.jst">DMZ</a></li><li class="nav-nat"><a role="menuitem"  href="nat.jst">NAT</a></li><li class="nav-staticrouting"><a role="menuitem"  href="staticrouting.jst">Static Routing</a></li><li class="nav-device-discovery"><a role="menuitem"  href="device_discovery.jst">Device Discovery</a></li></ul></li><li class="nav-troubleshooting"><a role="menuitem"  title="click to toggle sub menu"  class="top-level" href="troubleshooting_logs.jst">Troubleshooting</a><ul><li class="nav-logs"><a role="menuitem"  href="troubleshooting_logs.jst">Logs</a></li><li class="nav-diagnostic-tools"><a role="menuitem"  href="network_diagnostic_tools.jst">Diagnostic Tools</a></li><li class="nav-restore-reboot"><a role="menuitem"  href="restore_reboot.jst">Reset/Restore Gateway</a></li><li class="nav-password"><a role="menuitem"  href="password_change.jst">Change Password</a></li></ul></li></ul></div>

<script type="text/javascript">
$(document).ready(function() {
	comcast.page.init("Gateway > Initial Setup", "nav-initial-setup");
	$("label").addClass("label_style");
	var token = "gz46nsh67q";
	var isBridge = "router";
        var login_user = "cusadmin";

    if(isBridge != 'router'){
      //local network configuration should not be editable in bridge mode
      $('#pageForm *').addClass('disabled').prop("disabled", true);
     
	  return; //stop further processing
    };

    var jsGwIP = "10.1.10.1";
    var jsNetMask = "255.255.255.0";
    var jsLeaseTime = "604800";
    var jsV6LeaseTime = "";

	function updateIPv4() {
		if (netmask_is_validate() == false) {
			return;
		}

		var ip_addr = $("#ipv4_gateway_address_1").val() + "." + $("#ipv4_gateway_address_2").val() + "." + $("#ipv4_gateway_address_3").val() + "." + $("#ipv4_gateway_address_4").val();
		var subnet_mask = $("#ipv4_subnet_mask_1").val() + "." + $("#ipv4_subnet_mask_2").val() + "." + $("#ipv4_subnet_mask_3").val() + "." + $("#ipv4_subnet_mask_4").val();

		if (subnet_mask == "255.255.255.255") {
			var ipv4_dhcp_beginning_address = ip_addr;
			var ipv4_dhcp_ending_address = ip_addr;		
		} else {
			var ip = ip2long(ip_addr);
			var nm = ip2long(subnet_mask);
			var nw = ip & nm;
			var bc = nw | (~nm);
			var ipv4_dhcp_beginning_address = long2ip(nw + 1);
			var ipv4_dhcp_ending_address = long2ip(bc - 1);

                        if ( $("#ipv4_gateway_address_4").val() == "1" ) {
                                ipv4_dhcp_beginning_address = long2ip(nw + 2);
			}
		}
		var beginning_ip = ip_addr.split('.');
		var ending_ip = ipv4_dhcp_ending_address.split('.');
		ending_ip[3] -= 1;
		
		$("#ipv4_dhcp_beginning_address_1").val(replaceNaNwithEmptyString(beginning_ip[0]));
		$("#ipv4_dhcp_beginning_address_2").val(replaceNaNwithEmptyString(beginning_ip[1]));
		$("#ipv4_dhcp_beginning_address_3").val(replaceNaNwithEmptyString(beginning_ip[2]));
		$("#ipv4_dhcp_beginning_address_4").val(replaceNaNwithEmptyString(2));

		$("#ipv4_dhcp_ending_address_1").val(replaceNaNwithEmptyString(ending_ip[0]));
		$("#ipv4_dhcp_ending_address_2").val(replaceNaNwithEmptyString(ending_ip[1]));
		$("#ipv4_dhcp_ending_address_3").val(replaceNaNwithEmptyString(ending_ip[2]));
		$("#ipv4_dhcp_ending_address_4").val(replaceNaNwithEmptyString(ending_ip[3]));

		$("#ipv4_dhcp_beginning_address_1").prop("disabled", false);
		$("#ipv4_dhcp_ending_address_1").prop("disabled", false);
		$("#ipv4_dhcp_beginning_address_2").prop("disabled", false);
		$("#ipv4_dhcp_ending_address_2").prop("disabled", false);
		$("#ipv4_dhcp_beginning_address_3").prop("disabled", false);
		$("#ipv4_dhcp_ending_address_3").prop("disabled", false);
		$("#ipv4_dhcp_beginning_address_4").prop("disabled", false);
		$("#ipv4_dhcp_ending_address_4").prop("disabled", false);

		if ($("#ipv4_subnet_mask_1").val() == "255") {
			$("#ipv4_dhcp_beginning_address_1").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_1").prop("disabled", true);
		}

		if ($("#ipv4_subnet_mask_2").val() == "255") {
			$("#ipv4_dhcp_beginning_address_2").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_2").prop("disabled", true);
		}

		if ($("#ipv4_subnet_mask_3").val() == "255") {
			$("#ipv4_dhcp_beginning_address_3").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_3").prop("disabled", true);
		}

		if ($("#ipv4_subnet_mask_4").val() == "255") {
			$("#ipv4_dhcp_beginning_address_4").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_4").prop("disabled", true);
		}
	}//end of updateIPv4

	// Update range addresses automatically
	$(".gateway_address").blur(function() {
		updateIPv4();
	});
/*
	$("#ipv4_subnet_mask").change(function() {
		updateIPv4();
	});
*/
	function initPopulateDHCPv4(){
/*
		$("select#ipv4_subnet_mask").prop("disabled", false);
		$("select option").prop("disabled", false);
		$('#ipv4_dhcp_lease_time_measure').prop("disabled", false);

		if ($('#ipv4_dhcp_lease_time_measure').val() != "forever") 
			$('#ipv4_dhcp_lease_time_amount').prop("disabled", false);
*/
		if ($("#ipv4_subnet_mask_1").val() == "255") {
			$("#ipv4_dhcp_beginning_address_1").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_1").prop("disabled", true);
		}
		
		if ($("#ipv4_subnet_mask_2").val() == "255") {
			$("#ipv4_dhcp_beginning_address_2").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_2").prop("disabled", true);
		}
		
		if ($("#ipv4_subnet_mask_3").val() == "255") {
			$("#ipv4_dhcp_beginning_address_3").prop("disabled", true);
			$("#ipv4_dhcp_ending_address_3").prop("disabled", true);
		}
				
		if ($("#ipv4_subnet_mask_4").val() == "255") {
			$("#ipv4_dhcp_beginning_address_4").prop("disabled", true);		
			$("#ipv4_dhcp_ending_address_4").prop("disabled", true);
		}
	}

	initPopulateDHCPv4();

	// Disable time text field, if lease time is forever
	$("#ipv4_dhcp_lease_time_measure").change(function() {
		var $select = $(this);
		var $time = $("#ipv4_dhcp_lease_time_amount");
		if($select.find("option:selected").val() == "forever") {
			$time.prop("disabled", true).addClass("disabled").val();
		} else {
			$time.prop("disabled", false).removeClass("disabled").val();
		}
	}).trigger("change");


	jQuery.validator.addMethod("checkMask",function(value,element){		
		var netmask = $("#ipv4_subnet_mask_1").val() + "." + $("#ipv4_subnet_mask_2").val() + "." + $("#ipv4_subnet_mask_3").val() + "." + $("#ipv4_subnet_mask_4").val();
		if (netmask == '255.255.255.128'){
			return ((value>=2) && (value<=126));
		}
		else if (netmask == '255.255.255.252'){
			return  (value == 2);
		}
		else if (netmask == '255.255.255.0'){
			return ((value>=2) && (value<=(element.id == "ipv4_dhcp_ending_address_4" ? 253 : 254)));
		}
		else
		{
			return true;
		}
	}, "DHCP ending address is beyond the valid range.");

	$("#pageForm").validate({
		debug: true,
		onfocusout: false,
		onkeyup: false,
		groups: {
	    	ip_set: "ipv4_gateway_address_1 ipv4_gateway_address_2 ipv4_gateway_address_3 ipv4_gateway_address_4",
	    	net_mask: 	"ipv4_subnet_mask_1 ipv4_subnet_mask_2 ipv4_subnet_mask_3 ipv4_subnet_mask_4",
	    	b_range:"ipv4_dhcp_beginning_address_2, ipv4_dhcp_beginning_address_3, ipv4_dhcp_beginning_address_4",
	    	e_range:"ipv4_dhcp_ending_address_2, ipv4_dhcp_ending_address_3, ipv4_dhcp_ending_address_4",
		},
		rules: {
			ipv4_gateway_address_1: {
				required: true,
				min: 1,
				max: 255,
				digits: true
			},
			ipv4_gateway_address_2: {
				required: true,
				min: 0,
				max: 255,
				digits: true
			},
			ipv4_gateway_address_3: {
				required: true,
				min: 0,
				max: 255,
				digits: true
			},
			ipv4_gateway_address_4: {
				required: true,
				min: 1,
				max: 253,
				digits: true
			}
			,ipv4_dhcp_beginning_address_2: {
			    required: true,
				min: 0,
				max: 255,
				digits: true
			}
			,ipv4_dhcp_ending_address_2: {
			    required: true,
				min: 0,
				max: function(){
					var mask_2 = parseInt($("#ipv4_subnet_mask_2").val(),10);
					return (255-mask_2);
				},
				digits: true,
			}
			,ipv4_dhcp_beginning_address_3: {
			    required: true,
				min: 0,
				max: 255,
				digits: true
			}
			,ipv4_dhcp_ending_address_3: {
			    required: true,
				min: 0,
				max: function(){
					var mask_3 = parseInt($("#ipv4_subnet_mask_3").val(),10);
					return (255-mask_3);
				},
				digits: true,
			}
			,ipv4_dhcp_beginning_address_4: {
			    required: true,
				min: 2,
				max: 254,
				digits: true
			}
			,ipv4_dhcp_ending_address_4: {
			    required: true,
				min: 1,
				max: function(){
					var mask_3 = parseInt($("#ipv4_subnet_mask_3").val(),10);
					var mask_4 = parseInt($("#ipv4_subnet_mask_4").val(),10);
					var ending_address_3 = parseInt($("#ipv4_dhcp_ending_address_3").val(),10);
					var ipv4_DEA_4 = 255-mask_4-1;
					if((parseInt(mask_3,10) + parseInt(ending_address_3,10))>='255') return (ipv4_DEA_4-1);
					else return ipv4_DEA_4;
				},
				digits: true,
			}
			,ipv4_dhcp_lease_time_amount: {
				required: function() {
					return $("#ipv4_dhcp_lease_time_measure option:selected").val() != "forever";
				},
	            digits : true,
	            min: 1
	        }	        
		},
	    highlight: function( element, errorClass, validClass ) {
			$(element).closest(".form-row").find("input").addClass(errorClass).removeClass(validClass);
		},
		unhighlight: function( element, errorClass, validClass ) {
			$(element).closest(".form-row").find("input").removeClass(errorClass).addClass(validClass);
		}
	});

	jQuery.validator.addMethod("noHTML", function(value, element) {
		return this.optional(element) || ! /<\/?[^>]+(>|$)/g.test(value);
		}, "No HTML tags are allowed!");

	$("#pageForm2").validate({
		debug: true,
		onfocusout: false,
		onkeyup: false,
		rules: {
			https_filename: {
				required: true,
				noHTML: true
			}
		},
	    highlight: function( element, errorClass, validClass ) {
			$(element).closest(".form-row").find("input").addClass(errorClass).removeClass(validClass);
		},
		unhighlight: function( element, errorClass, validClass ) {
			$(element).closest(".form-row").find("input").removeClass(errorClass).addClass(validClass);
		}
	});

		$.validator.addMethod("hexadecimal", function(value, element) {
    		return this.optional(element) || /^[a-fA-F0-9]+$/i.test(value);
    	}, "Only hexadecimal characters are valid. Acceptable characters are ABCDEF0123456789.");

	$("#restore-default-settings-ipv4").click(function(e) {
		e.preventDefault();

		jConfirm(
		"Are you sure you want the change LAN IPv4 to default settings?"
		,"Reset Default IPv4 Settings"
		,function(ret) {
		if(ret) {

		$("#ipv4_gateway_address_1").val(10);
		$("#ipv4_gateway_address_2").val(1);
		$("#ipv4_gateway_address_3").val(10);
		$("#ipv4_gateway_address_4").val(1);
		
		$("#ipv4_subnet_mask_1").val(255)
		$("#ipv4_subnet_mask_2").val(255)
		$("#ipv4_subnet_mask_3").val(255)
		$("#ipv4_subnet_mask_4").val(0)

		$("#ipv4_dhcp_beginning_address_1").val(10);
		$("#ipv4_dhcp_beginning_address_2").val(1);
		$("#ipv4_dhcp_beginning_address_3").val(10);
		$("#ipv4_dhcp_beginning_address_4").val(2);

		$("#ipv4_dhcp_ending_address_1").val(10);
		$("#ipv4_dhcp_ending_address_2").val(1);
		$("#ipv4_dhcp_ending_address_3").val(10);
		$("#ipv4_dhcp_ending_address_4").val(253);
		
		$("#ipv4_dhcp_lease_time_amount").val(1);
		$("#ipv4_dhcp_lease_time_measure").val("weeks");

		var ipaddr = "10.1.10.1"; //ares specific requirement
		var subnet_mask = "255.255.255.0"; 
		var dhcp_begin_addr = "10.1.10.2";
		var dhcp_end_addr = "10.1.10.253";
		var lease_time = 604800; // 1 week	

		//==================================ares specific
		var routername = "BWG/ARES";
		//var dmz_enable = "false";
		//var dmz_host   = "10.1.10.5";
        var Config = '{"Ipaddr":"' + ipaddr + '", "Subnet_mask":"' + subnet_mask + '", "Dhcp_begin_addr":"' + dhcp_begin_addr + 
        			'", "Dhcp_end_addr":"' + dhcp_end_addr +'", "Dhcp_lease_time":"' + lease_time + '", "routername":"' + routername + '"}';
        			//'", "dmz_enable":"' + dmz_enable + '", "dmz_host":"' + dmz_host + '"}';
        
	    setIPconfiguration(Config,ipaddr);

		} //end of if ret
		});
	});//end of click

/*var gw_ip_1 = parseInt($('#ipv4_gateway_address_1').val());
if (gw_ip_1 == 172){
	//gw ip is B class ip address		
	if( $('#mask4').length>0 ) $('#mask4').remove();
	if( ! $('#mask2').length>0 ) mask2Option.insertAfter('#mask1');
}
else if (gw_ip_1 == 192){
	//gw ip is C class ip address
	if( $('#mask2').length>0 ) $('#mask2').remove();
	if( $('#mask4').length>0 ) $('#mask4').remove();
}*/

// $('#ipv4_gateway_address_1').change(function(){
// 	var gw_ip1 = parseInt($('#ipv4_gateway_address_1').val());

//     var mask2Option = $('<option id="mask2" value="255.255.0.0">255.255.0.0</option>');
//     var mask4Option = $('<option id="mask4" value="255.0.0.0">255.0.0.0</option>');

//     if (gw_ip1 == 10){
// 		if( ! $('#mask2').length>0 ) mask2Option.insertAfter('#mask1');
// 		if( ! $('#mask4').length>0 ) mask4Option.insertAfter('#mask3');
//     }
//     else if (gw_ip1 == 172){
// 		//gw ip is B class ip address
// 		if( $('#mask4').length>0 ) $('#mask4').remove();
// 		if( ! $('#mask2').length>0 ) mask2Option.insertAfter('#mask1');
// 	}
// 	else if (gw_ip1 == 192){
// 		//gw ip is C class ip address
// 		if( $('#mask2').length>0 ) $('#mask2').remove();
// 		if( $('#mask4').length>0 ) $('#mask4').remove();
// 	}
// });

function ipv4_valid_range(){
	var gw4_1 = parseInt($("#ipv4_gateway_address_1").val());
	var gw4_2 = parseInt($("#ipv4_gateway_address_2").val());
	var gw4_3 = parseInt($("#ipv4_gateway_address_3").val());
	var gw4_4 = parseInt($("#ipv4_gateway_address_4").val());

	var ip_addr = gw4_1 + "." + gw4_2 + "." + gw4_3 + "." + gw4_4;
	var subnet_mask = $("#ipv4_subnet_mask_1").val() + "." + $("#ipv4_subnet_mask_2").val() + "." + $("#ipv4_subnet_mask_3").val() + "." + $("#ipv4_subnet_mask_4").val();

	if (subnet_mask == "255.255.255.255") {
		var ipv4_dhcp_beginning_address = ip_addr;
		var ipv4_dhcp_ending_address = ip_addr;
	} else {
		var ip = ip2long(ip_addr);
		var nm = ip2long(subnet_mask);
		var nw = ip & nm;
		var bc = nw | (~nm);
		var ipv4_dhcp_beginning_address = long2ip(nw + 1);
		var ipv4_dhcp_ending_address = long2ip(bc - 1);
	}
	var beginning_ip = ipv4_dhcp_beginning_address;
	var ending_ip = ipv4_dhcp_ending_address.split('.');
	ending_ip[3] -= 1;
	ending_ip = ending_ip.join('.');
	return [beginning_ip, ending_ip];
}

/* 
 This function checks dhcpv4 ending address should be larger than begin address
 @DBArr = Array(dhcp begin dot address partial 2, 3, 4)
 @DEArr = Array(dhcp ending dot address partial 2, 3, 4)
 */
function validate_v4addr_pool(DBArr, DEArr) {
	
	var flag = true;

	if (DEArr[0] < DBArr[0]) {
		flag = false;
	}
	else if (DEArr[0] == DBArr[0]) {
		if (DEArr[1] < DBArr[1]) {
			flag = false;
		}
		else if (DEArr[1] == DBArr[1]) {
			if (DEArr[2] < DBArr[2]) {
				flag = false;
			}			
		}
	}

	return flag;
}

function is_ipv4_in_range(ipv4_addr, ipv4_start, ipv4_end) {
	var ipv4_num = ip4StrToBin(ipv4_addr);
	return (ipv4_num >= ip4StrToBin(ipv4_start)) && (ipv4_num <= ip4StrToBin(ipv4_end));
}
function netmask_is_validate()
	{
		var netmask = $("#ipv4_subnet_mask_1").val() + "." + $("#ipv4_subnet_mask_2").val() + "." + $("#ipv4_subnet_mask_3").val() + "." + $("#ipv4_subnet_mask_4").val();
		return judgeSubnetMask(netmask);
	}

function judgeSubnetMask(ipAddress){
		var ip_addr = $("#ipv4_gateway_address_1").val();
		var exp="";
		if(ip_addr=="10" || ip_addr=="172" || ip_addr=="192" ){
			exp="^(((255\.){3}(255|254|252|248|240|224|192|128|0+))|((255\.){2}(255|254|252|248|240|224|192|128|0+)\.0)|((255\.)(255|254|252|248|240|224|192|128|0+)(\.0+){2})|((255|254|252|248|240|224|192|128|0+)(\.0+){3}))$";
		}
		var str = ipAddress;
		var patt = new RegExp(exp);
		var res= patt.test(str);
		if(patt.test(str)==true)
			return true;
		else
			return false;
	}

function long2ip (ip) {
			if (!isFinite(ip))
			return false

			return [ip >>> 24, ip >>> 16 & 0xFF, ip >>> 8 & 0xFF, ip & 0xFF].join('.')
		}
//  discuss at: https://locutus.io/php/ip2long/
  // original by: Waldo Malqui Silva (https://waldo.malqui.info)
  // improved by: Victor
  //  revised by: fearphage (https://my.opera.com/fearphage/)
  //  revised by: Theriault (https://github.com/Theriault)
  //    estarget: es2015
  //   example 1: ip2long('192.0.34.166')
  //   returns 1: 3221234342
  //   example 2: ip2long('0.0xABCDEF')
  //   returns 2: 11259375
  //   example 3: ip2long('255.255.255.256')
  //   returns 3: false
function ip2long (IP) {
			var i = 0

			IP = IP.match(
				/^([1-9]\d*|0[0-7]*|0x[\da-f]+)(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?$/i
			) // Verify IP format.
			if (!IP) {
				// Invalid format.
				return false
			}
			// Reuse IP variable for component counter.
			IP[0] = 0
			for (i = 1; i < 5; i += 1) {
				IP[0] += !!((IP[i] || '')
				.length)
				IP[i] = parseInt(IP[i]) || 0
			}
			// Continue to use IP for overflow values.
			IP.push(256, 256, 256, 256)
			IP[4 + IP[0]] *= Math.pow(256, 4 - IP[0])
			if (IP[1] >= IP[5] || IP[2] >= IP[6] || IP[3] >= IP[7] || IP[4] >= IP[8]) {
				return false
			}
			return IP[1] * (IP[0] === 1 || 16777216) + IP[2] * (IP[0] <= 2 || 65536) + IP[3] * (IP[0] <= 3 || 256) + IP[4] * 1
		}
function replaceNaNwithEmptyString(value) {
			if(isNaN(value)) {
				return "";
			} else {
				return value;
			}
		}
function validate_v4addr_subnetRange(DBArr, DEArr) {
	ipv4_valid_range_ip	= ipv4_valid_range();
	var beginning_ip 	= ipv4_valid_range_ip[0];
	var ending_ip 		= ipv4_valid_range_ip[1];
	return is_ipv4_in_range(DBArr, beginning_ip, ending_ip) && is_ipv4_in_range(DEArr, beginning_ip, ending_ip);
}

$('#submit_ipv4').click(function(e){
	e.preventDefault();

    var dhcp4B2 = parseInt($("#ipv4_dhcp_beginning_address_2").val());
	var dhcp4B3 = parseInt($("#ipv4_dhcp_beginning_address_3").val());
	var dhcp4B4 = parseInt($("#ipv4_dhcp_beginning_address_4").val());
	var dhcp4E2 = parseInt($("#ipv4_dhcp_ending_address_2").val());
	var dhcp4E3 = parseInt($("#ipv4_dhcp_ending_address_3").val());
	var dhcp4E4 = parseInt($("#ipv4_dhcp_ending_address_4").val());
	var gtE2 = parseInt($("#ipv4_gateway_address_2").val());
        var gtE3 = parseInt($("#ipv4_gateway_address_3").val());
	var gtE4 = parseInt($("#ipv4_gateway_address_4").val());

	var DBArr = Array(dhcp4B2, dhcp4B3, dhcp4B4);
	var DEArr = Array(dhcp4E2, dhcp4E3, dhcp4E4);
	var GWArr = Array(gtE2, gtE3, gtE4);

	var ipaddr = $('#ipv4_gateway_address_1').val() + "." + $('#ipv4_gateway_address_2').val() + "." + $('#ipv4_gateway_address_3').val() + "." + $('#ipv4_gateway_address_4').val();
	var subnet_mask = $("#ipv4_subnet_mask_1").val() + "." + $("#ipv4_subnet_mask_2").val() + "." + $("#ipv4_subnet_mask_3").val() + "." + $("#ipv4_subnet_mask_4").val();
	var dhcp_begin_addr = $('#ipv4_dhcp_beginning_address_1').val() + "." + $('#ipv4_dhcp_beginning_address_2').val() + "." + $('#ipv4_dhcp_beginning_address_3').val() + "." + $('#ipv4_dhcp_beginning_address_4').val();
	var dhcp_end_addr = $('#ipv4_dhcp_ending_address_1').val() + "." + $('#ipv4_dhcp_ending_address_2').val() + "." + $('#ipv4_dhcp_ending_address_3').val() + "." + $('#ipv4_dhcp_ending_address_4').val();

    if (netmask_is_validate() == false) {
                jAlert("Invalid netmask!");
                return;
    }

    if (! validate_v4addr_pool(GWArr,DBArr)) {
        jAlert("Beginning Address can't be smaller than gateway address!");
        return;
    }
    if (! validate_v4addr_pool(DBArr, DEArr)) {
        jAlert("Beginning Address can't be larger than ending address!");
        return;
    }

    if (! validate_v4addr_subnetRange(dhcp_begin_addr, dhcp_end_addr)) {
        jAlert("Either Gateway or DHCP Begin/End Addresses are invaid, please input again!");
        return;
    }

    var gw_ip1 = parseInt($('#ipv4_gateway_address_1').val());
    var gw_ip2 = parseInt($('#ipv4_gateway_address_2').val());
    var gw_ip3 = parseInt($('#ipv4_gateway_address_3').val());
     if( ((gw_ip1 != 10) && (gw_ip1 != 172) && (gw_ip1 != 192)) || ((gw_ip1 == 172) && ((gw_ip2<16) || (gw_ip2>31)))  || ((gw_ip1== 192) && ((gw_ip2 != 168) || (gw_ip3== 147)) ) ){
		jAlert("Gateway IP is not in valid private IP range\n [10.0.0.1 ~ 10.255.255.253,\n172.16.0.1 ~ 172.31.255.253,\n192.168.0.1 ~ 192.168.146.253,\n192.168.148.1 ~ 192.168.255.253]");
    	return;
    }
    if (((gw_ip1==192) && (gw_ip2==168) && (gw_ip3==100))|| ((gw_ip1==172) && (gw_ip2==31))) {
        jAlert("This IP address is reserved , please input again");
        return;
    }
    if ((gw_ip1==172) && (gw_ip2==16) && (gw_ip3==12)) {
    	jAlert("This IP address is reserved for Home Security, please input again");
    	return;
    }

    //=======================================Ares specific
    var routername = $('#router_name').val();


    if($('#DMZ').is(':checked')){
    	var dmz_host = $('#ipv4_DMZ_1').val() + '.' + $('#ipv4_DMZ_2').val() + '.' + $('#ipv4_DMZ_3').val() + '.' + $('#ipv4_DMZ_4').val();
    	var IPv4Config = '{"Ipaddr":"' + ipaddr + '", "Subnet_mask":"' + subnet_mask + '", "Dhcp_begin_addr":"' + dhcp_begin_addr + 
			             '", "Dhcp_end_addr":"' + dhcp_end_addr + '", "routername":"' + routername + 
			             '", "dmz_enable":"true", "dmz_host":"' + dmz_host + '"}';

	    var host0 = parseInt($("#ipv4_DMZ_1").val());
	    var host1 = parseInt($("#ipv4_DMZ_2").val());
	    var host2 = parseInt($("#ipv4_DMZ_3").val());
	    var host3 = parseInt($("#ipv4_DMZ_4").val());
	    //to check whether user input DMZ host is a valid ip address	    
	    if (dmz_host == ipaddr){
	    		jAlert("DMZ Host IP can't be equal to the Gateway IP address !");
	    		return;
	    	}
		//alert(jsNetMask);
		if(jsNetMask.indexOf('255.255.255') >= 0){
			//the first three field should be equal to gw ip field
			if((gw_ip1 != host0) || (gw_ip2 != host1) || (gw_ip3 != host2)){
			  var msg = 'DMZ Host IP is not in valid range:\n' + gw_ip1+'.'+gw_ip2+'.'+gw_ip3+'.[2~254]';
			  jAlert(msg);
			  return;
			}		
		}
		else if(jsNetMask == "255.255.0.0"){
			if((gw_ip1 != host0) || (gw_ip2 != host1)){
			  jAlert('DMZ Host IP is not in valid range:\n' + gw_ip1+ '.' + gw_ip2 + '.[0~255]' + '.[2~254]');
			  return;
			}		
		}
		else{
			if(gw_ip1 != host0){
			  jAlert("DMZ Host IP is not valid, please input again !");
			  return;
			}		
		}
    }
    else
		var IPv4Config = '{"dmz_disable":"true", "Ipaddr":"' + ipaddr + '", "Subnet_mask":"' + subnet_mask + '", "Dhcp_begin_addr":"' + dhcp_begin_addr + 
						'", "Dhcp_end_addr":"' + dhcp_end_addr + '", "routername":"' + routername + '"}';
   	setIPconfiguration(IPv4Config,ipaddr);
});

function setIPconfiguration(configuration,ipaddr){

	if($("#pageForm").valid()){
                var ipaddr = $('#ipv4_gateway_address_1').val() + "." + $('#ipv4_gateway_address_2').val() + "." + $('#ipv4_gateway_address_3').val() + "." + $('#ipv4_gateway_address_4').val();
                var subnet_mask = $("#ipv4_subnet_mask_1").val() + "." + $("#ipv4_subnet_mask_2").val() + "." + $("#ipv4_subnet_mask_3").val() + "." + $("#ipv4_subnet_mask_4").val();
                var dhcp_begin_addr = $('#ipv4_dhcp_beginning_address_1').val() + "." + $('#ipv4_dhcp_beginning_address_2').val() + "." + $('#ipv4_dhcp_beginning_address_3').val() + "." + $('#ipv4_dhcp_beginning_address_4').val();
                var dhcp_end_addr = $('#ipv4_dhcp_ending_address_1').val() + "." + $('#ipv4_dhcp_ending_address_2').val() + "." + $('#ipv4_dhcp_ending_address_3').val() + "." + $('#ipv4_dhcp_ending_address_4').val();
                var IPaddress = "10.1.10.1";
                var Lan_Subnet_Mask = "255.255.255.0";
                var dhcp_min_addr = "10.1.10.2";
                var dhcp_max_addr = "10.1.10.253";
            if((IPaddress === ipaddr) && (Lan_Subnet_Mask === subnet_mask) && (dhcp_min_addr  === dhcp_begin_addr) && (dhcp_max_addr === dhcp_end_addr)){
               jProgress("This may take several seconds.",60);
                  $.ajax({
                type:"POST",
                url:"actionHandler/ajaxSet_initial_setup.jst",
                data: { configInfo: configuration,csrfp_token: token  },
                success:function(){
                        jHide();
                        window.location.reload();
                    },
                error: function(){
                        jHide();
                        jAlert("Error! Please try later!");
                     }
            });

         }
          else{    
		var str = 'Changing Gateway IP or any DHCP setting would reset the gateway.\n';
		str += '\n';
		str += '<b>WARNING</b>: Gateway will be rebooted!\n';
		str += 'Incoming/Outgoing call and internet connection will be interrupted!';
		jConfirm(
		str
		,"Are you sure?"
		,function(ret) {
			if(ret) {
				jProgress('This may take several seconds', 60);
				$.ajax({
					type: "POST",
					url: "actionHandler/ajaxSet_initial_setup.jst",
					data: { configInfo: configuration,csrfp_token: token },
					success: function(){
						jHide();
						jProgress("Please wait for rebooting ...", 999999);
					},
					error: function(){
						jHide();
						jProgress("Please wait for rebooting ...", 999999);
					}
				});
				if(login_user == "cusadmin")
				{                        
					setTimeout(function(){
						jHide();
						window.location.replace('http://' + ipaddr + '/index.jst');
					}, 4 * 60 * 1000); 
                                }
                                else
                                {
                                        setTimeout(checkForRebooting, 4 * 60 * 1000);
                                }
			}
		});
	}
    }
}

function calcuate_lease_time(num, unit){
   
    switch (unit) {
	case 'seconds':
		return num;
		break;
	case 'minutes':
		return num * 60;
		break;
	case 'hours':
		return num * 3600;
		break;
	case 'days': 
		return num * 3600 * 24;
		break;	
	case 'weeks': 
		return num * 3600 * 24 * 7;
		break;	
	case 'forever':
	    return -1;
	    break;	
   }
}

  display_time_format(jsLeaseTime);

function display_time_format(num){

	if (num == "") return;
    var timeNum = parseInt(num);
	var TimeVal  = '#ipv4_dhcp_lease_time_amount';

	if ( (timeNum % 604800) == 0) {
       $(TimeVal).val(timeNum / 604800);
       $('#ipv4_dhcp_lease_time_measure option[value="weeks"]').prop("selected", true);
	}
	else if( (timeNum % 86400) == 0 ) {
	   $(TimeVal).val(timeNum / 86400);
       $('#ipv4_dhcp_lease_time_measure option[value="days"]').prop("selected", true);
	}
	else if( (timeNum % 3600) == 0 ) {
	   $(TimeVal).val(timeNum / 3600);
       $('#ipv4_dhcp_lease_time_measure option[value="hours"]').prop("selected", true);
	}
	else if( (timeNum % 60) == 0 ) {
	   $(TimeVal).val(timeNum / 60);
       $('#ipv4_dhcp_lease_time_measure option[value="minutes"]').prop("selected", true);
	}
	else if( timeNum == -1) {
	   $(TimeVal).prop("disabled", true);
       $('#ipv4_dhcp_lease_time_measure option[value="forever"]').prop("selected", true);
	}
	else {
	   $(TimeVal).val(timeNum);
       $('#ipv4_dhcp_lease_time_measure option[value="seconds"]').prop("selected", true);
	}
}


function checkForRebooting() {
    $.ajax({
    type: "GET",
    url: "index.jst",
    timeout: 10000,
        success: function() {
                /* goto login page once the box reboots*/
                window.open ("index.jst","_self");
                setTimeout(window.close(),1000);
           },
           error: function() {
                /* retry after 2 minutes */
                setTimeout(checkForRebooting, 30 * 1000);
           }
    });
}
  
//========enable/disable Lan DHCP server
$('#Lan').click(function(){
	if ( $(this).is(':checked') ) {
		var jsConfig = '{"enableDHCP":"true"}';		
	}
	else{
		var jsConfig = '{"enableDHCP":"false"}';	
	}
	      jProgress("This may take several seconds.",60);
				$.ajax({
				type:"POST",
				url:"actionHandler/ajaxSet_initial_setup.jst",
				data: { configInfo : jsConfig,csrfp_token: token },
				success:function(){
					jHide();
                                        window.location.reload();
				},
				error: function(){
					jHide();
					jAlert("Error! Please try later!");
				}
			});
});

/*$('#DMZ').click(function(){
	if ( $(this).is(':checked') ) {
		var configInfo = '{enableDMZ:"true"}';		
	}
	else{
		var configInfo = '{enableDMZ:"false"}';	
	}
	saveConfig(configInfo);
});
*/

var DHCPEnable = "true";
var DMZEnalbe  = "false";

if (DHCPEnable == 'false'){
	document.getElementById('ipv4_gateway_address_1').disabled= true;
	document.getElementById('ipv4_gateway_address_2').disabled=true;
	document.getElementById('ipv4_gateway_address_3').disabled=true;
	document.getElementById('ipv4_gateway_address_4').disabled=true;
	
	document.getElementById('ipv4_subnet_mask_1').disabled=true;
	document.getElementById('ipv4_subnet_mask_2').disabled=true;
	document.getElementById('ipv4_subnet_mask_3').disabled=true;
	document.getElementById('ipv4_subnet_mask_4').disabled=true;

	document.getElementById('ipv4_dhcp_beginning_address_1').disabled=true;
	document.getElementById('ipv4_dhcp_beginning_address_2').disabled=true;
	document.getElementById('ipv4_dhcp_beginning_address_3').disabled=true;		
	document.getElementById('ipv4_dhcp_beginning_address_4').disabled=true;
	document.getElementById('ipv4_dhcp_ending_address_1').disabled=true;
	document.getElementById('ipv4_dhcp_ending_address_2').disabled=true;
	document.getElementById('ipv4_dhcp_ending_address_3').disabled=true;		
	document.getElementById('ipv4_dhcp_ending_address_4').disabled=true;
}

if (DMZEnalbe == 'false'){
	document.getElementById('ipv4_DMZ_1').disabled=true;
	document.getElementById('ipv4_DMZ_2').disabled=true;
	document.getElementById('ipv4_DMZ_3').disabled=true;
	document.getElementById('ipv4_DMZ_4').disabled=true;
}

}); //end of document ready

//================================================

function edmz()
{
	if( document.getElementById('DMZ').checked==true)
	{
		document.getElementById('ipv4_DMZ_1').disabled=false;
		document.getElementById('ipv4_DMZ_2').disabled=false;
		document.getElementById('ipv4_DMZ_3').disabled=false;
		document.getElementById('ipv4_DMZ_4').disabled=false;
	}
	else
	{
		document.getElementById('ipv4_DMZ_1').disabled=true;
		document.getElementById('ipv4_DMZ_2').disabled=true;
		document.getElementById('ipv4_DMZ_3').disabled=true;
		document.getElementById('ipv4_DMZ_4').disabled=true;
	}	
}

</script>


<div id="content">
	<h1>Gateway > Initial Setup</h1>

	<div id="educational-tip">
		<p class="tip">Manage Initial Setup settings.</p>
		<p class="hidden"><strong>LAN IP address:</strong> Enter the IP address of the LAN.</p>
		<p class="hidden"><strong>LAN Subnet Mask:</strong> The subnet mask is associated with the IP address.</p>
		<p class="hidden"><strong>DHCP Starting and Ending Addresses:</strong> The DHCP server in the Gateway allows the router to manage IP address assignment for the connected devices.</p>
		<p class="hidden"><strong>DMZ Host IP:</strong> Enter the IP address of the DMZ Host</p>
		<p class="hidden"><strong>Router Name:</strong> Enter the name of the Router</p>
		<p class="hidden"><strong>TFTP Server:</strong> Enter the IP address of the TFTP server</p>
		<p class="hidden"><strong>File Name:</strong> Enter the name of the configuration file to be download</p>
	</div>

	<form action="#TBD" method="post" id="pageForm">
	   <input type="hidden" name="restore_factory_settings" id="restore_factory_settings" class="restore_factory_settings" value="false" />
    <div class="module forms">
   	    <h2>Initial Setup</h2>

			<div class="form-row">
				<input type="checkbox"  name="lan" checked value="Lan" id="Lan" />
				<label for="Lan" class="acs-hide"></label>
				<b>Enable LAN DHCP</b>
			</div>		

    		<div class="form-row odd">
    			<label for="ipv4_gateway_address_1">Lan IP Address:</label>
    			
                <input type="text" size="3" maxlength="3"  value="10" id="ipv4_gateway_address_1" name="ipv4_gateway_address_1" class="gateway_address smallInput"> 
    	        <label for="ipv4_gateway_address_2" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="1" id="ipv4_gateway_address_2" name="ipv4_gateway_address_2" class="gateway_address smallInput"> 
    	        <label for="ipv4_gateway_address_3" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="10" id="ipv4_gateway_address_3" name="ipv4_gateway_address_3" class="gateway_address smallInput"> 
    	        <label for="ipv4_gateway_address_4" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="1" id="ipv4_gateway_address_4"  name="ipv4_gateway_address_4" class="gateway_address smallInput" />
    		</div>
    		<div class="form-row ">
    			<label for="ipv4_subnet_mask">Lan Subnet Mask:</label>
    			
				<input type="text" size="3" maxlength="3"  value="255" id="ipv4_subnet_mask_1" name="ipv4_subnet_mask_1" class="gateway_address smallInput" />
				<label for="ipv4_subnet_mask_2" class="acs-hide"></label>
				.<input type="text" size="3" maxlength="3" value="255" id="ipv4_subnet_mask_2" name="ipv4_subnet_mask_2" class="gateway_address smallInput" />
				<label for="ipv4_subnet_mask_3" class="acs-hide"></label>
				.<input type="text" size="3" maxlength="3" value="255" id="ipv4_subnet_mask_3" name="ipv4_subnet_mask_3" class="gateway_address smallInput" />
				<label for="ipv4_subnet_mask_4" class="acs-hide"></label>
				.<input type="text" size="3" maxlength="3" value="0" id="ipv4_subnet_mask_4" name="ipv4_subnet_mask_4" class="gateway_address smallInput" />
    	    </div>
    		<div class="form-row odd">
    			<label for="ipv4_dhcp_beginning_address_1">DHCP Start IP:</label>
                  
    			<input type="text" size="3" maxlength="3" value="10" id="ipv4_dhcp_beginning_address_1" name="ipv4_dhcp_beginning_address_1" class="smallInput" />
    	        <label for="ipv4_dhcp_beginning_address_2" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="1" id="ipv4_dhcp_beginning_address_2" name="ipv4_dhcp_beginning_address_2" class="smallInput" />
    	        <label for="ipv4_dhcp_beginning_address_3" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="10" id="ipv4_dhcp_beginning_address_3" name="ipv4_dhcp_beginning_address_3" class="smallInput" />
    	        <label for="ipv4_dhcp_beginning_address_4" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="2" id="ipv4_dhcp_beginning_address_4" name="ipv4_dhcp_beginning_address_4" class="smallInput" />
    	        
    		</div>
    		<div class="form-row ">
                <label for="ipv4_dhcp_ending_address_1">DHCP End IP:</label>
                 
				<input type="text" size="3" maxlength="3" value="10" id="ipv4_dhcp_ending_address_1" name="ipv4_dhcp_ending_address_1" class="smallInput" />
    	        <label for="ipv4_dhcp_ending_address_2" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="1" id="ipv4_dhcp_ending_address_2" name="ipv4_dhcp_ending_address_2" class="smallInput" />
    	        <label for="ipv4_dhcp_ending_address_3" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="10" id="ipv4_dhcp_ending_address_3" name="ipv4_dhcp_ending_address_3" class="smallInput" />
    	        <label for="ipv4_dhcp_ending_address_4" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="253" id="ipv4_dhcp_ending_address_4" name="ipv4_dhcp_ending_address_4" class="smallInput"  />
    	       
    		 </div>

			
			<div class="form-row odd">
				<input type="checkbox"  name="DMZ" value="DMZ" id="DMZ" onClick="edmz()" /><b>Enable DMZ Host</b>
				<label for="DMZ" class="acs-hide"></label>
			</div>			
    		<div class="form-row ">
    			<label for="ipv4_DMZ_1">DMZ Host IP:</label>
                 <input type="text" size="3" maxlength="3" value="0" id="ipv4_DMZ_1" name="ipv4_DMZ_1" class="smallInput" />
                 <label for="ipv4_DMZ_2" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="0" id="ipv4_DMZ_2" name="ipv4_DMZ_2" class="smallInput" />
                 <label for="ipv4_DMZ_3" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="0" id="ipv4_DMZ_3" name="ipv4_DMZ_3" class="smallInput" />
                 <label for="ipv4_DMZ_4" class="acs-hide"></label>
    	        .<input type="text" size="3" maxlength="3" value="0" id="ipv4_DMZ_4" name="ipv4_DMZ_4" class="smallInput" />
    		</div>
			
		

    		<div class="form-row odd" >
    			<label for="router_name" class="in_setup">Router Name:</label>
    			<input type="text" size="15" maxlength="15" value="Gateway" name="routername" id="router_name" class=" in_setup" />
    	    </div>			

			<div class="form-btn odd">
					<input id="submit_ipv4" name="submit_ipv4" type="button" value="Save Settings" class="btn" />
					<input id="restore-default-settings-ipv4" name="restore-default-settings-ipv4" type="button" value="Restore Default Settings" class="btn alt" />
				</div>
    		</div> <!-- End Module -->			

			</form>

</div><!-- end #content -->

<!-- $Id: footer.jst 2976 2009-09-02 21:42:51Z cporto $ -->
		</div> <!-- end #main-content-->
		
		<!--Footer-->
		<div id="footer">
			<ul id="footer-links" class="hidden">
				<li class="first-child"><a href="http://www.xfinity.com" target="_blank">Xfinity.com</a></li>
				<li class="footer_style">&#8226;&nbsp;&nbsp;<a href="https://customer.comcast.com/" target="_blank">customerCentral</a></li>
				<li class="footer_style">&#8226;&nbsp;&nbsp;<a href="http://customer.comcast.com/userguides" target="_blank">User Guide</a></li>
			</ul>
		</div> <!-- end #footer -->
	</div> <!-- end #container -->
<script type="text/javascript">
$(document).ready(function() {
	// focus current page link, must after page.init()
	//$('#nav [href="'+location.href.replace(/^.*\//g, '')+'"]').focus();		// need a "skip nav" function
	$("#skip-link").click(function () {
        $('#content').attr('tabIndex', -1).focus();  //this is to fix skip-link doesn't work on webkit-based Chrome
    });

	// change radio-btn status and do ajax when press "enter"
	//$(".radio-btns a").keydown(function(event){
	$(".radio-btns a").keypress(function(event){
		var keycode = (event.keyCode ? event.keyCode : event.which);
		if(13 == keycode){
			if (!$(this).parent(".radio-btns").find("li").hasClass("selected")){
				return;		// do nothing if has disabled class, don't detect disabled attr for radio-btn
			}
			// console.log($(this).find(":radio").hasClass("disabled"));
			$(this).find(":radio").trigger('click');
			$(this).find(":radio").trigger('change');
			$(this).parent(".radio-btns").radioToButton();
		}
	});
	
	// press Esc to skip menu and goto first control of content
	// Esc:keypress:which is zero in FF, Esc:keypress is not work in Chrome
	$("#nav").keydown(function(event){
		var keycode = (event.keyCode ? event.keyCode : event.which);
		if(27 == keycode){
			$("#content textarea:eq(0)").focus();
			$("#content input:eq(0)").focus();
			$("#content a:eq(0)").focus();			// high priority element to focus			
		}
		// alert(event.keyCode+"---"+event.which+"---"+event.charCode);		
	});
	
	/* changes for high contrast mode */
	$.highContrastDetect({useExtraCss: true, debugInNormalMode: false});
	if ($.__isHighContrast) {
		/* change plus/minus tree indicator of nav menu */
		$("#nav a.top-level").prepend('<span class="hi_nav_top_indi">[+]</span>');
		$("#nav a.folder").prepend('<span class="hi_nav_folder_indi">[+]</span>');
		$("#nav a.top-level-active span.hi_nav_top_indi").text("[-]");
		$("#nav a.folder").click(function() {
			/* this should be called after nav state changed */
			var $link = $(this);
			if ($link.hasClass("folder-open")) {
				$link.children("span.hi_nav_folder_indi").text("[-]");
			}
			else {
				$link.children("span.hi_nav_folder_indi").text("[+]");
			}
		});
	}

	/*
	*	these 3 sections for radio-btn accessibility, as a workaround, maybe should put at the front of .ready().
	*/
	// add "role" and "title" for ARIA, attr may need to be embedded into html
	$(".radio-btns a").each(function(){
		$(this).attr("role", "radio").attr("title", $(this).closest("ul").prev().text() + $(this).find("label").text());
	});
	
	// monitor "aria-checked" status for JAWS, NOTE: better depends on input element
	$(".radio-btns").change(function(){
		$(this).find("a").each(function(){
			$(this).attr("aria-checked", $(this).find("input").attr("checked") ? "true" : "false");
		});
	});
	
	//give the initial status, do not trigger change above
	$(".radio-btns").find("a").each(function(){
		$(this).attr("aria-checked", $(this).find("input").attr("checked") ? "true" : "false");
	});

});
</script>	
</body>
</html>


